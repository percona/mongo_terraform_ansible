# Deploy hardware for MongoDB clusters using Terraform in Docker

## Pre-requisites

1. Install Docker

2. Clone this repository on your machine and `cd` to it

    ```
    cd mongo_terraform_ansible
    ```

3. Initialize Terraform 

    ```
    terraform init
    ```

## Quick guide

1. Prepare the configuration file

    ```
    vi variables.tf
    ```

2. Run Terraform to create resources

    ```
    terraform apply
    ``` 

3. Add the SSH configuration file generated by Terraform to your machine to connect easily. For example: 

    ```
    cat ssh_config >> ~/.ssh/config
    ```

    Modify the config as needed depending on your environment

4. Copy the generated inventory for Ansible
    ```
    cp inventory ../../ansible/
    ```

- Look inside the [ansible](ansible) folder for instructions to complete the deployment of a complete MongoDB cluster

## Minimum variables to customize

These are the ones you have to care about for a quick deploy with default values:

- env_tag

    This is just a prefix for the name of your environment. Make sure nobody else is using the same one in the project

- ssh_users

    List of SSH usernames and path to their public keys to configure access to your instances

- my_ssh_user

    Your own SSH user. This is used to generate an SSH config file for you